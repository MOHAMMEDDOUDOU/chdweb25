# دليل التحول من Supabase إلى Neon

## الخطوات المطلوبة للتحول

### 1. إعداد قاعدة بيانات Neon

1. اذهب إلى [neon.tech](https://neon.tech) وأنشئ حساب جديد
2. أنشئ مشروع جديد
3. احصل على رابط الاتصال من لوحة التحكم
4. أضف رابط الاتصال إلى ملف `.env.local`:

\`\`\`env
NEON_DATABASE_URL=postgresql://username:password@host:port/database?sslmode=require
\`\`\`

### 2. إنشاء جدول المنتجات

1. افتح SQL Editor في لوحة تحكم Neon
2. انسخ محتوى ملف `database/schema.sql`
3. نفذ الأوامر لإنشاء الجدول والفهارس

### 3. تثبيت التبعيات الجديدة

\`\`\`bash
npm install pg @types/pg
# أو
pnpm add pg @types/pg
\`\`\`

### 4. نقل البيانات (اختياري)

إذا كنت تريد نقل البيانات الموجودة من Supabase:

\`\`\`sql
-- تصدير البيانات من Supabase
-- ثم استيرادها إلى Neon باستخدام نفس هيكل الجدول
\`\`\`

### 5. اختبار التطبيق

1. تأكد من أن جميع المتغيرات البيئية صحيحة
2. شغل التطبيق: `npm run dev`
3. اختبر إدارة المنتجات في `/admin/products`

## الملفات المحدثة

### ملفات جديدة:
- `lib/neonClient.ts` - تكوين اتصال Neon
- `lib/database.ts` - وظائف قاعدة البيانات
- `app/api/products/route.ts` - API للمنتجات
- `app/api/products/[id]/route.ts` - API لمنتج واحد
- `database/schema.sql` - هيكل قاعدة البيانات

### ملفات محدثة:
- `app/admin/products/page.tsx` - تحديث لاستخدام API الجديد
- `package.json` - إضافة تبعية pg

## الميزات الجديدة

1. **API RESTful**: واجهة برمجة تطبيقات قياسية للتعامل مع المنتجات
2. **أداء محسن**: فهارس قاعدة البيانات لتحسين سرعة الاستعلامات
3. **معالجة أخطاء محسنة**: رسائل خطأ واضحة ومفيدة
4. **دعم JSON**: تخزين المقاسات والصور كـ JSON
5. **تحديث تلقائي**: تحديث `updated_at` تلقائياً

## ملاحظات مهمة

- تأكد من أن رابط الاتصال يحتوي على `sslmode=require`
- احتفظ بنسخة احتياطية من البيانات قبل التحول
- اختبر جميع الوظائف بعد التحول
- يمكنك إزالة `@supabase/supabase-js` من التبعيات بعد التأكد من عمل كل شيء

## استكشاف الأخطاء

### مشكلة الاتصال بقاعدة البيانات:
- تأكد من صحة رابط الاتصال
- تأكد من إضافة `sslmode=require`
- تحقق من إعدادات Firewall

### مشكلة في API:
- تحقق من سجلات الخادم
- تأكد من صحة هيكل البيانات المرسلة
- تحقق من وجود الجدول في قاعدة البيانات
